---
title: "Clustering"
output: html_document
date: "2024-01-29"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=F}
library(gridExtra)
library(factoextra)
library(flexclust)
library(fpc)
### library(clustertend)
library(hopkins)
library(cluster)
library(ClusterR)
library(stats)
library(corrplot)
```
## Introduction

Objective of this project is to gain insights into the relation between sleep patterns and lifestyle factors using unsupervised learning techniques. 
Identifying clusters of individuals with similar sleep patterns and lifestyle characteristics can contribute to the development of tailored strategies and better recommendations for improving sleep quality and overall well-being.

```{r}
#reading data
health<-read.csv("Sleep_health_and_lifestyle_dataset.csv")
head(health,10)

#chcking data structure
str(health)

#data summary
summary(health)

#checking data for null values
health<-health[complete.cases(health), ]

#converting chr to factor
health$BMI.Category<-as.factor(health$BMI.Category)
health$Blood.Pressure <-as.factor(health$Blood.Pressure)

#converting factor to integer
health$BMI.Category<-as.integer(health$BMI.Category)
health$Blood.Pressure <-as.integer(health$Blood.Pressure)

health<-health[c(3,5,6,7,8,9,10,11,12)]

str(health)
head(health,10)
```
## Exploratory data anlysis

Now i will examine the dataset, identify anomalies, and gain insights through visualizations. This process helps us understand the data's structure, select relevant features, and prepare for subsequent clustering algorithms.

### plot columns

At first i want to show plots of every column. Understanding data distributes might be very useful.
```{r }

for (i in colnames(health)) {
  hist(health[,i], main = paste("Plot of ", i))
}
```

```{r}
health_matrix <- data.matrix(health, rownames.force = NA)
M <- cor(health_matrix)
corrplot(M, method = "number", number.cex = 0.75, order="hclust")
```

```{r,echo=F}
#scaling values
health_scaled<-scale(health)

##clustering

a <- fviz_nbclust(health_scaled, FUNcluster = kmeans, method = "silhouette") + theme_classic() 
b <- fviz_nbclust(health_scaled, FUNcluster = cluster::pam, method = "silhouette") + theme_classic() 
c <- fviz_nbclust(health_scaled, FUNcluster = cluster::clara, method = "silhouette") + theme_classic() 
d <- fviz_nbclust(health_scaled, FUNcluster = hcut, method = "silhouette") + theme_classic() 
e <- fviz_nbclust(health_scaled, FUNcluster = cluster::fanny, method = "silhouette") + theme_classic() 
```

```{r}

grid.arrange(a, b, c, d, e, ncol=2)
```


